//problem1

#include "ecRCC2.h"
#include "ecGPIO2.h"

#define BUTTON_PIN PC_13

void setup(void)
{
		RCC_HSI_init();	
	
		// Initialize the LED pin as an output
	
    GPIO_init(PA_5, OUTPUT);    
    GPIO_otype(PA_5, OPP);
    GPIO_ospeed(PA_5, MS);
    GPIO_pupd(PA_5, NPUPD);
	
		GPIO_init(PA_6, OUTPUT);    
    GPIO_otype(PA_6, OPP);
    GPIO_ospeed(PA_6, MS);
    GPIO_pupd(PA_6, NPUPD);
	
		GPIO_init(PA_7, OUTPUT);    
    GPIO_otype(PA_7, OPP);
    GPIO_ospeed(PA_7, MS);
    GPIO_pupd(PA_7, NPUPD);
		
		GPIO_init(PB_6, OUTPUT);    
    GPIO_otype(PB_6, OPP);
    GPIO_ospeed(PB_6, MS);
    GPIO_pupd(PB_6, NPUPD);                                           
	
		GPIO_init(BUTTON_PIN, INPUT);  // calls RCC_GPIOC_enable()
		sevensegment_display_init(PA_5, PA_6, PA_7, PB_6);  // Decoder input A,B,C,D
		
		GPIO_write(PA_5, 0);
		GPIO_write(PA_6, 0);
		GPIO_write(PA_7, 0);
		GPIO_write(PB_6, 0);
}
	
int main(void) { 
	// Initialiization 
	setup();
	unsigned int cnt = 0;
	
	// Inifinite Loop 
	while(1){
		sevensegment_display(cnt % 10);
		if(GPIO_read(BUTTON_PIN) == 0) cnt++; 
        if (cnt > 9) cnt = 0;  
		Delay(1000);
	}
}
