#include "ecRCC2.h"    
#include "ecGPIO2.h"   

#define BUTTON_PIN PC_13  

void setup(void)
{
    RCC_HSI_init();  // 내부 고속 클록 초기화

    // LED 핀들을 출력으로 초기화
    GPIO_init(PA_5, OUTPUT);    
    GPIO_otype(PA_5, OPP);      
    GPIO_ospeed(PA_5, MS);      
    GPIO_pupd(PA_5, NPUPD);  

    // 나머지 핀들도 유사하게 초기화 (PA_6, PA_7, PB_6, PC_7, PA_9, PA_8)

    GPIO_init(BUTTON_PIN, INPUT);  // 버튼 핀을 입력으로 설정
    sevensegment_decoder_init(PA_5, PA_6, PA_7, PB_6, PC_7, PA_9, PA_8);  // 7세그먼트 디코더 초기화

    // 모든 LED를 꺼진 상태로 초기화
    GPIO_write(PA_5, 0);
    GPIO_write(PA_6, 0);
    GPIO_write(PA_7, 0);
    GPIO_write(PB_6, 0);
    GPIO_write(PC_7, 0);
    GPIO_write(PA_9, 0);
    GPIO_write(PA_8, 1);
}

int main(void) { 
    setup();  
    unsigned int cnt = 0; 

    while(1){  // 무한 루프
        sevensegment_decoder(cnt % 10); 
        if(GPIO_read(BUTTON_PIN) == 0) cnt++; 
        if (cnt > 9) cnt = 0; 
        Delay(1000); 
    }
}
